# Потоковые шифры

### Симметричные шифры

`шифр` - ключи (K), открытие тексты (M), шифр тексты (C)

алгоритмы (E, D) - эффективные (можно вычислить за полиномиальное время), такие что:
+ Алгоритм E (почти случайный) действует на простаранстве ключей и открытых текстов и выдает шифр текст E: K $\times$ M $\to$ C
+ Алгоритм D (детерминированный) действует на пространстве ключей и шифр текстов и выдает открытый текст D: K $\times$ C $\to$ M

последовательное применение алгоритмов дает исходное сообщение D(K,E(K,m)) = m

### Шифр Вернама 
(одноразовый блокнот) *OTP - one time pad*  -   Теоритически стойкий шифр

1. текст преобразовали в последовательность бит

$$
M = \{0, 1\}^n 
$$

$$
C = \{0, 1\}^n
$$

$$
K = \{0, 1\}^n
$$

$$
E: m \oplus k = c
$$

$$
D: c \oplus k = m
$$

---

<br>

### Теоретически стойкий шифр (идеальный шифр)

**Опр** 

$$
\forall m_0m_1: |m_0| = |m_1|
$$

$$
\forall c \in C
$$

$$
P_r[E(k,m_0)=c]=P_r[E(k,m_1)=c]
$$

---

*one time pad*  -   Теоритически стойкий шифр

$$
\forall m, c
$$

$$
P_r[E(k,m)=c]=\frac{\\#K:E(k,m) = c}{|K|} \=> \frac{1}{2^n}
$$

#K - количество ключей для данного шифрования

|K| - простраснство ключей 

**теоритический стойкий шифр**, если $|K|\ge|M|$

---

<br>

### Потоковый шифр

Как использовать короткий ключ на длинное сообщение

PRC генератор псевдо случайных чисел 

$G: \underbrace{\{0,1\}^S}_{Seed}\to \{0,1\}^n$ , seed $S\gg n$

$$
K=\{0,1\}^S \qquad M = C = \{0,1\}^n
$$

seed -битовая последовательность длины S

```
                    K
                  /  \
                /      \
              /          \
        ------------------------
        |         G(k)         |
        ------------------------
                   xor
        ------------------------
        |           m          |
        ------------------------
        ________________________
        ------------------------
        |           c          |
        ------------------------
      
```

Представим PRG - предсказуем (значит по данным можно предсказать следующие данные)

$$
\exists i \space G(k) [1, \dots, i-1] \to G(k) [1, \dots, n]
$$

Алгоритм А (владеет им Ева) 

```
Ева знает первые байти ОТ
Как Ева по данным первых
бит достраивает генератор
и находит открытый текст
        ------------------------
        |           c          |  \
        ------------------------    \
xor                                   \
        ------------------------        x
m       |   ...   |    ....    |      /
        ------------------------    /
        |   G(k)  |            |  /
        |[1...i-1]|............|
               \     /
                 \ /
                  A
```


**Определение предсказуемого генератора** 

PRG - $G: \{0,1\}^S\to\{0,1\}^n$ называется предсказуемым, если $\exists A$ "эффективный" $\exists\space 1\le i\le n-1$

$$
P_r\big[A(G(k)[1\dots i-1]=G(k)[i]> \frac{1}{2}+\varepsilon\big]
$$


$$
\varepsilon> \dfrac{1}{2^{30}}
$$

---

<br>

### Атаки на потоковый шифр

+ Двузразовый блокнот 

$$
m_1 \neq m_2
$$

$$
c_1=m_1 \oplus G(k) \quad \oplus \quad c_2=m_2\oplus G(k)
$$

$$
C_1\oplus c_2=m_1\oplus m_2
$$

$$
\underbrace{c_1\oplus c_2}_{\text{Ева знает}}=
$$

$$
\underbrace{m_1\oplus m_2}_{\text{не является псевдослучайными данными}}
$$

Генератор псевдослучайных чисел - запускается один раз, а затем разбивается на части псевдослучайных последовательностей разных сообщений. 

---

<br>

802.11b WEB (Wered Equivalent Privacy) 128 bit

```
client                            точка доступа
            |m    |   CRC (m)|
                            xor
            |   PRG(IV||k)   |
            IV  |      ШТ    |

```

|| - конкатинация (слепление)

номер кадра - 24 бит (чистый инкремент, это плохо, потому что у этих ключей в префиксе отличается только один бит, а суффик остается неизменным) (решение - как можно реже менять ключ)

$2^{24} \approx 16,000,000$ кадров $=>$ двухразовый блокнот


+ Нарушение целостности

Потоковые шифры никак не защищены от модификаций

`Модификации ШТ не обнаруживаются и имеют предсказуемое, прямое вляние на ОТ`

```
m = FROM Bob ---------> /F/R/O/M/ /B/o/b/ ---> ШТ
                enc                            |
                                     xor       |
                                               |
                                              
```

---

<br>

### Безоопасный генератор псевдослучайных чисел

$G:\underbrace{\{0,1\}^S}_{K}\to\{0,1\}^n$

$n\gg S$

Пусть $n\isin K=s^S$


$$
A: \space A(x)^{\{0,1\}^n}=\begin{cases}
   0 &\text{if x - не случ; бесконечно малое G(k)} \\
   1 &\text{if x - случ}
\end{cases}
$$

---

<br>

### Статистический тест

`Беред на вход последовательность длины n и выдает 1 если она случайная и 0, в обратном случае`

**Опр** Случайная последовательность - последовательность, которую нельзя описать математическим алгоритмом (физический процесс (белый шум))

$]G:K\to\{0,1\1^n$ и $A$ - статистический тест

$$

**Опр** Генератор безопасен - если не существует эффективного статистического текста, который отличает его вывод от случайной последовательности




























